{"version":3,"sources":["pages/Users/UserForm.js","pages/Users/UserEdit.js"],"names":["UserForm","state","adminChecked","toggleAdmin","e","_this","setState","target","checked","passwordValidator","rule","value","callback","form","props","type","getFieldValue","id","handleSubmit","preventDefault","validateFields","err","values","save","this","user","flag_admin","getFieldDecorator","react_default","a","createElement","es_form","onSubmit","className","Item","initialValue","input","hasFeedback","rules","required","concat","es_select","Option","login","prefix","icon","onPressEnter","placeholder","validator","nickname","bio","TextArea","rows","email","url","valuePropName","es_checkbox","onChange","es_button","htmlType","Component","Form","create","newUser","user_id","password","UserEdit","saveNew","axios","post","then","infoMessage","push","catch","errorMessage","response","status","statusText","data","saveUpdate","put","loadUser","loading","match","params","userId","get","res","Object","objectSpread","layout","Content","style","padding","textAlign","Users_UserForm","connect","loadingActive","navigation","dispatch","active","message"],"mappings":"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","file":"static/js/8.efd78882.chunk.js","sourcesContent":["import React, {Component} from 'react';\r\nimport {Button, Checkbox, Form, Icon, Input, Select} from 'antd';\r\nimport PropTypes from 'prop-types';\r\n\r\nclass UserForm extends Component {\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.setState({ adminChecked: (this.props.user.flag_admin === 1)});\r\n\t}\r\n\r\n\tstate = {\r\n\t\tadminChecked: false\r\n\t};\r\n\r\n\ttoggleAdmin = (e) => this.setState({adminChecked: e.target.checked});\r\n\r\n\tpasswordValidator = (rule, value, callback) => {\r\n\t\tconst form = this.props.form;\r\n\t\tconst type = form.getFieldValue('type');\r\n\t\tconst id = form.getFieldValue('id');\r\n\t\tif (type === '2' && value) {\r\n\t\t\tcallback('A guest cannot have a password');\r\n\t\t} else if (type === '1' && !id && !value) {\r\n\t\t\tcallback('A user must have a password');\r\n\t\t} else {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t};\r\n\r\n\thandleSubmit = (e) => {\r\n\t\te.preventDefault();\r\n\t\tthis.props.form.validateFields((err, values) => {\r\n\t\t\tif (!err) {\r\n\t\t\t\tthis.props.save(values);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst {getFieldDecorator} = this.props.form;\r\n\r\n\t\treturn (\r\n\t\t\t<Form onSubmit={this.handleSubmit} className='login-form'>\r\n\t\t\t\t<Form.Item>\r\n\t\t\t\t\t{getFieldDecorator('id', {\r\n\t\t\t\t\t\tinitialValue: this.props.user.id\r\n\t\t\t\t\t})(<Input type=\"hidden\" />)}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item hasFeedback>\r\n\t\t\t\t\t{getFieldDecorator('type', {\r\n\t\t\t\t\t\trules: [{required: true}],\r\n\t\t\t\t\t\tinitialValue: `${this.props.user.type}`\r\n\t\t\t\t\t})(<Select>\r\n\t\t\t\t\t\t<Select.Option value='1'>User</Select.Option>\r\n\t\t\t\t\t\t<Select.Option value='2'>Guest</Select.Option>\r\n\t\t\t\t\t</Select>)}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item hasFeedback>\r\n\t\t\t\t\t{getFieldDecorator('login', {\r\n\t\t\t\t\t\trules: [{required: true}],\r\n\t\t\t\t\t\tinitialValue: this.props.user.login\r\n\t\t\t\t\t})(<Input\r\n\t\t\t\t\t\tprefix={<Icon type='user'/>}\r\n\t\t\t\t\t\tonPressEnter={this.handleSubmit}\r\n\t\t\t\t\t\tplaceholder='Username'\r\n\t\t\t\t\t/>)}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item hasFeedback>\r\n\t\t\t\t\t{getFieldDecorator('password', {\r\n\t\t\t\t\t\trules: [{validator: this.passwordValidator}]\r\n\t\t\t\t\t})(<Input\r\n\t\t\t\t\t\tprefix={<Icon type='lock'/>}\r\n\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\tonPressEnter={this.handleSubmit}\r\n\t\t\t\t\t\tplaceholder='Password'\r\n\t\t\t\t\t/>)}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item hasFeedback>\r\n\t\t\t\t\t{getFieldDecorator('nickname', {\r\n\t\t\t\t\t\tinitialValue: this.props.user.nickname\r\n\t\t\t\t\t})(<Input\r\n\t\t\t\t\t\tonPressEnter={this.handleSubmit}\r\n\t\t\t\t\t\tplaceholder='Nickname'\r\n\t\t\t\t\t/>)}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item hasFeedback>\r\n\t\t\t\t\t{getFieldDecorator('bio', {\r\n\t\t\t\t\t\tinitialValue: this.props.user.bio\r\n\t\t\t\t\t})(<Input.TextArea\r\n\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t\tplaceholder='Bio'\r\n\t\t\t\t\t/>)}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item hasFeedback>\r\n\t\t\t\t\t{getFieldDecorator('email', {\r\n\t\t\t\t\t\trules: [{type: 'email'}],\r\n\t\t\t\t\t\tinitialValue: this.props.user.email\r\n\t\t\t\t\t})(<Input\r\n\t\t\t\t\t\tonPressEnter={this.handleSubmit}\r\n\t\t\t\t\t\tplaceholder='Email'\r\n\t\t\t\t\t/>)}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item hasFeedback>\r\n\t\t\t\t\t{getFieldDecorator('url', {\r\n\t\t\t\t\t\trules: [{type: 'url'}],\r\n\t\t\t\t\t\tinitialValue: this.props.user.url\r\n\t\t\t\t\t})(<Input\r\n\t\t\t\t\t\tonPressEnter={this.handleSubmit}\r\n\t\t\t\t\t\tplaceholder='Website'\r\n\t\t\t\t\t/>)}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item>\r\n\t\t\t\t\t{getFieldDecorator('flag_admin', {\r\n\t\t\t\t\t\tvaluePropName: 'flag_admin',\r\n\t\t\t\t\t\tinitialValue: (this.props.user.flag_admin === 1)\r\n\t\t\t\t\t})(\r\n\t\t\t\t\t\t<Checkbox\r\n\t\t\t\t\t\t\tchecked={this.state.adminChecked}\r\n\t\t\t\t\t\t\tonChange={this.toggleAdmin}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tAdministrator\r\n\t\t\t\t\t\t</Checkbox>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Form.Item>\r\n\t\t\t\t<Form.Item>\r\n\t\t\t\t\t<Button type='primary' htmlType='submit' className='login-form-button'>\r\n\t\t\t\t\t\tSave\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Form.Item>\r\n\t\t\t</Form>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nUserForm.propTypes = {\r\n\tuser: PropTypes.object.isRequired,\r\n\tsave: PropTypes.func.isRequired\r\n};\r\n\r\nexport default Form.create()(UserForm);","import React, {Component} from 'react';\r\nimport {Layout} from 'antd';\r\nimport UserForm from './UserForm';\r\nimport axios from 'axios/index';\r\nimport {connect} from 'react-redux';\r\nimport {push} from 'react-router-redux';\r\nimport {errorMessage, infoMessage, loading} from '../../actions/navigation';\r\n\r\nconst newUser = {\r\n\tuser_id: null,\r\n\ttype: 1,\r\n\tlogin: null,\r\n\tpassword: null,\r\n\tnickname: null,\r\n\tflag_admin: false\r\n};\r\n\r\nclass UserEdit extends Component {\r\n\r\n\tstate = {\r\n\t\tuser: null,\r\n\t\tsave: () => {}\r\n\t};\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.loadUser();\r\n\t}\r\n\r\n\tsaveNew = (user) => {\r\n\t\taxios.post('/api/users', user)\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.props.infoMessage('User successfully created');\r\n\t\t\t\tthis.props.push('/users');\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tthis.props.errorMessage(`${err.response.status}: ${err.response.statusText}. ${err.response.data}`);\r\n\t\t\t});\r\n\t};\r\n\r\n\tsaveUpdate = (user) => {\r\n\t\taxios.put(`/api/users/${user.id}`, user)\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.props.infoMessage('User successfully edited');\r\n\t\t\t\tthis.props.push('/users');\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tthis.props.errorMessage(`${err.response.status}: ${err.response.statusText}. ${err.response.data}`);\r\n\t\t\t});\r\n\t};\r\n\r\n\tloadUser = () => {\r\n\t\tthis.props.loading(true);\r\n\t\tif (this.props.match && this.props.match.params.userId) {\r\n\t\t\taxios.get(`/api/users/${this.props.match.params.userId}`)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tthis.setState({user: res.data, save: this.saveUpdate});\r\n\t\t\t\t\tthis.props.loading(false);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tthis.props.errorMessage(`${err.response.status}: ${err.response.statusText}. ${err.response.data}`);\r\n\t\t\t\t\tthis.props.loading(false);\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.setState({user: {...newUser}, save: this.saveNew});\r\n\t\t\tthis.props.loading(false);\r\n\t\t}\r\n\t};\r\n\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Layout.Content style={{padding: '25px 50px', textAlign: 'center'}}>\r\n\t\t\t\t{this.state.user && (<UserForm user={this.state.user} save={this.state.save} />)}\r\n\t\t\t</Layout.Content>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n\tloadingActive: state.navigation.loading\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch) => ({\r\n\tloading: (active) => dispatch(loading(active)),\r\n\tinfoMessage: (message) => dispatch(infoMessage(message)),\r\n\terrorMessage: (message) => dispatch(errorMessage(message)),\r\n\tpush: (url) => dispatch(push(url))\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserEdit);"],"sourceRoot":""}