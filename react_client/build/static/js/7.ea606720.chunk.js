(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{313:function(e,t,a){"use strict";a.d(t,"a",function(){return _});var n=a(330),r=a.n(n),s=a(331),i=a(347),o=a(20),c=a(21),l=a(23),u=a(22),p=a(24),f=a(0),h=a.n(f),m=a(332),d=a.n(m),g=a(80),b=a(508),v=a(509),y=a(505),E=a(136),S=a(517),C=a(526),O=a(54),w=a(15),j=a(49),k=a.n(j),x=a(314),V=a.n(x),_=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={value:a.props.value||[],inputVisible:!1,DS:[]},a.handleClose=function(e){var t=a.state.value.filter(function(t){return t!==e});a.setState({value:t}),a.props.onChange&&a.props.onChange(t)},a.showInput=function(){a.setState({inputVisible:!0},function(){return a.input.focus()})},a.handleInputConfirm=function(e){var t=a.state.value;e&&-1===t.indexOf(e)&&(t=Object(i.a)(t).concat([e])),a.setState({value:t,inputVisible:!1}),a.props.onChange&&a.props.onChange(t)},a.getTags=function(){var e=Object(s.a)(r.a.mark(function e(t,a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t){e.next=2;break}return e.abrupt("return",{data:[]});case 2:return e.abrupt("return",k.a.get("/api/tags",{params:{type:a,filter:t}}));case 3:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),a.getSeries=function(){var e=Object(s.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t){e.next=2;break}return e.abrupt("return",{data:[]});case 2:return e.abrupt("return",k.a.get("/api/series",{params:{filter:t}}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.search=function(e){"tag"===a.props.search&&a.searchTags(e),"serie"===a.props.search&&a.searchSeries(e),"lang"===a.props.search&&a.searchLangs(e)},a.searchLangs=function(e){var t=[];V.a.all().forEach(function(e){return t.push({value:e["2B"],text:e.name})}),t.push({value:"mul",text:"Multi-languages"}),t.push({value:"und",text:"Undefined Language"}),t.push({value:"zxx",text:"No Linguistic Content"}),a.setState({DS:a.sortByProp(t,"text")||[]})},a.searchSeries=function(e){a.getSeries(e).then(function(e){a.setState({DS:e.data.content.map(function(e){return e.name})||[]})})},a.searchTags=function(e){a.getTags(e,a.props.tagType).then(function(e){var t=e.data.content.map(function(e){return{value:e.name,text:e.name_i18n}})||[];t=a.sortByProp(t,"text"),a.setState({DS:t})})},a.onCheck=function(e){a.props.onChange&&a.props.onChange(e)},a.sortByProp=function(e,t){return e.sort(function(e,a){return e[t]>a[t]?1:e[t]<a[t]?-1:0})},a.props.checkboxes&&a.search(),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.value,n=t.inputVisible;return this.props.checkboxes?h.a.createElement("div",null,h.a.createElement(g.a.Group,{defaultValue:this.state.value,style:{width:"100%"},onChange:this.onCheck},h.a.createElement(b.a,null,this.state.DS.map(function(e){return h.a.createElement(v.a,{align:"left",span:8},h.a.createElement(g.a,{value:e.value},e.text))})))):h.a.createElement("div",null,a.map(function(t){t||(t="");var a=t.length>20,n=h.a.createElement(y.a,{key:t,closable:"true",afterClose:function(){return e.handleClose(t)}},a?"".concat(t.slice(0,20),"..."):t);return a?h.a.createElement(E.a,{title:t,key:t},n):n}),n&&h.a.createElement(S.a.Item,{wrapperCol:{span:10,offset:0}},h.a.createElement(C.a,{ref:function(t){return e.input=t},dataSource:this.state.DS,onSearch:this.search,onChange:function(t){return e.currentVal=t},filterOption:function(e,t){return-1!==d()(t.props.children.toUpperCase()).indexOf(d()(e).toUpperCase())}}),h.a.createElement(O.a,{type:"primary",onClick:function(){return e.handleInputConfirm(e.currentVal)},className:"login-form-button"},"Add Tag")),!n&&h.a.createElement(y.a,{onClick:this.showInput,style:{background:"#fff",borderStyle:"dashed"}},h.a.createElement(w.a,{type:"plus"})," Add"))}}]),t}(h.a.Component)},528:function(e,t,a){"use strict";a.r(t);var n=a(36),r=a(20),s=a(21),i=a(23),o=a(22),c=a(24),l=a(0),u=a.n(l),p=a(521),f=a(522),h=a(517),m=a(136),d=a(15),g=a(61),b=a(508),v=a(509),y=a(79),E=a(505),S=a(54),C=a(313),O=a(314),w=a.n(O),j=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).showSelect=function(){a.setState({selectVisible:!0},function(){return a.select.focus()})},a.handleSubmit=function(e){e.preventDefault(),a.state.i18n.length>0?a.props.form.validateFields(function(e,t){if(!e){var n={};a.state.i18n.forEach(function(e){n[e]=t["lang_".concat(e)],delete t["lang_".concat(e)]}),t.i18n=n,a.props.save(t)}}):f.a.error("A series must have at least one name by language")},a.addLang=function(e){if(!a.state.i18n.includes(e)){var t=a.state.i18n.concat([e]);a.setState({i18n:t})}a.setState({selectVisible:!1})},a.removeLang=function(e){if(a.state.i18n.includes(e)){var t=a.state.i18n.filter(function(t){return t!==e});a.setState({i18n:t})}},a.state={i18n:[],languages:[],selectVisible:!1},w.a.all().forEach(function(e){return a.state.languages.push({value:e["2B"],text:e.name})}),a.props.serie.i18n&&Object.keys(a.props.serie.i18n).forEach(function(e){a.state.i18n.push(e),a.state["lang_".concat(e)]=a.props.serie.i18n[e]}),console.log(a.state),console.log(a.props.serie),a}return Object(c.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.state.i18n[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value,i={};i["lang_".concat(s)]=this.props.serie.i18n[s],this.props.form.setFieldsValue(i)}}catch(o){t=!0,a=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw a}}this.props.form.validateFields()}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state.selectVisible;return u.a.createElement(h.a,{onSubmit:this.handleSubmit,className:"serie-form"},u.a.createElement(h.a.Item,{hasFeedback:!0,label:u.a.createElement("span",null,"Original Name\xa0",u.a.createElement(m.a,{title:"This is the internal name used to reference the series in Karaoke Mugen's database"},u.a.createElement(d.a,{type:"question-circle-o"}))),labelCol:{span:3},wrapperCol:{span:8,offset:0}},t("name",{initialValue:this.props.serie.name,rules:[{required:!0,message:"Please enter a name"}]})(u.a.createElement(g.a,{placeholder:"Series name",label:"Series name"}))),u.a.createElement(h.a.Item,{label:u.a.createElement("span",null,"Aliase(s)\xa0",u.a.createElement(m.a,{title:"Short names or alternative names a series could be searched. Example : DB for Dragon Ball, or FMA for Full Metal Alchemist, or AnoHana for that series which makes you cry everytime you watch it."},u.a.createElement(d.a,{type:"question-circle-o"}))),labelCol:{span:3},wrapperCol:{span:10,offset:0}},t("aliases",{initialValue:this.props.serie.aliases})(u.a.createElement(C.a,{search:"aliases",onChange:function(t){return e.props.form.setFieldsValue({aliases:t.join(",")})}}))),u.a.createElement("div",null,"Names by language\xa0",u.a.createElement(m.a,{title:"There must be at least one name in any language (enter the original name by default)"},u.a.createElement(d.a,{type:"question-circle-o"}))),this.state.i18n.map(function(a){return u.a.createElement(b.a,{gutter:8},u.a.createElement(h.a.Item,{hasFeedback:!0,label:w.a.where("2B",a).name,labelCol:{span:3},wrapperCol:{span:16,offset:0}},t("lang_"+a,{initialValue:e.state["lang_".concat(a)],rules:[{required:!0,message:"Please enter a translation"}]})(u.a.createElement(v.a,{span:12},u.a.createElement(g.a,{placeholder:"Name in that language",defaultValue:e.state["lang_".concat(a)],label:a}))),Object.keys(e.state.i18n).length>1?u.a.createElement(v.a,{span:2},u.a.createElement(m.a,{title:"Remove name"},u.a.createElement(d.a,{className:"dynamic-delete-button",type:"minus-circle-o",disabled:1===e.state.i18n.length,onClick:function(){return e.removeLang(a)}}))):null))}),a&&u.a.createElement(h.a.Item,{label:"Select a language",labelCol:{span:3},wrapperCol:{span:4,offset:0}},u.a.createElement(y.a,{showSearch:!0,ref:function(t){return e.select=t},onChange:function(t){return e.addLang(t)}},this.state.languages.map(function(e){return u.a.createElement(y.a.Option,{value:e.value},'"',e.text," (",e.value.toUpperCase(),')"')}))),!a&&u.a.createElement(E.a,{onClick:this.showSelect,style:{borderStyle:"dashed"}},u.a.createElement(d.a,{type:"plus"})," Add"),u.a.createElement(h.a.Item,{wrapperCol:{span:4,offset:2}},u.a.createElement(S.a,{type:"primary",htmlType:"submit",className:"series-form-button"},"Save series")),u.a.createElement(h.a.Item,null,t("serie_id",{initialValue:this.props.serie.serie_id})(u.a.createElement(g.a,{type:"hidden"}))),u.a.createElement(h.a.Item,null,t("i18n",{initialValue:this.props.serie.i18n})(u.a.createElement(g.a,{type:"hidden"}))))}}]),t}(l.Component),k=h.a.create()(j),x=a(49),V=a.n(x),_=a(25),M=a(41),D=a(27),I={name:null,aliases:[],i18n:{}},T=function(e){function t(){var e,a;Object(r.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(c)))).state={serie:null,save:function(){}},a.saveNew=function(e){V.a.post("/api/series",e).then(function(){a.props.infoMessage("Series successfully created"),a.props.push("/series")}).catch(function(e){a.props.errorMessage("".concat(e.response.status,": ").concat(e.response.statusText,". ").concat(e.response.data))})},a.saveUpdate=function(e){V.a.put("/api/series/".concat(e.serie_id),e).then(function(){a.props.infoMessage("Series successfully edited"),a.props.push("/series")}).catch(function(e){a.props.errorMessage("".concat(e.response.status,": ").concat(e.response.statusText,". ").concat(e.response.data))})},a.loadSerie=function(){a.props.loading(!0),a.props.match&&a.props.match.params.serie_id?V.a.get("/api/series/".concat(a.props.match.params.serie_id)).then(function(e){var t=Object(n.a)({},e.data);t.serie_id=a.props.match.params.serie_id,a.setState({serie:t,save:a.saveUpdate}),a.props.loading(!1)}).catch(function(e){a.props.errorMessage("".concat(e.response.status,": ").concat(e.response.statusText,". ").concat(e.response.data)),a.props.loading(!1)}):(a.setState({serie:Object(n.a)({},I),save:a.saveNew}),a.props.loading(!1))},a}return Object(c.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.loadSerie()}},{key:"render",value:function(){return u.a.createElement(p.a.Content,{style:{padding:"25px 50px",textAlign:"center"}},this.state.serie&&u.a.createElement(k,{serie:this.state.serie,save:this.state.save}))}}]),t}(l.Component);t.default=Object(_.b)(function(e){return{loadingActive:e.navigation.loading}},function(e){return{loading:function(t){return e(Object(D.i)(t))},infoMessage:function(t){return e(Object(D.h)(t))},errorMessage:function(t){return e(Object(D.g)(t))},push:function(t){return e(Object(M.c)(t))}}})(T)}}]);
//# sourceMappingURL=7.ea606720.chunk.js.map